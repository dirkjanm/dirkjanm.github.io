<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="965px" height="338px" viewBox="-0.5 -0.5 965 338"><defs/><path d="M 525 27 L 764.84 27" fill="none" stroke="#000000" stroke-width="4.5" stroke-miterlimit="10" pointer-events="none"/><path d="M 774.97 27 L 761.47 33.75 L 764.84 27 L 761.47 20.25 Z" fill="#000000" stroke="#000000" stroke-width="4.5" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(517.5,-1.5)scale(1.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="170" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;background-color:#ffffff;">1: Negotiate authentication<br /></div></div></foreignObject><text x="85" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">1: Negotiate authentication&lt;br&gt;</text></switch></g><path d="M 780 102 L 540.16 102" fill="none" stroke="#000000" stroke-width="4.5" stroke-miterlimit="10" pointer-events="none"/><path d="M 530.03 102 L 543.53 95.25 L 540.16 102 L 543.53 108.75 Z" fill="#000000" stroke="#000000" stroke-width="4.5" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(569.5,73.5)scale(1.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="120" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;background-color:#ffffff;">2: Server challenge<br /></div></div></foreignObject><text x="60" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">2: Server challenge&lt;br&gt;</text></switch></g><path d="M 525 172.5 L 764.84 172.5" fill="none" stroke="#000000" stroke-width="4.5" stroke-miterlimit="10" pointer-events="none"/><path d="M 774.97 172.5 L 761.47 179.25 L 764.84 172.5 L 761.47 165.75 Z" fill="#000000" stroke="#000000" stroke-width="4.5" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(465.5,193.5)scale(1.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="259" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;background-color:#ffffff;">3: Authenticate (copied signed challenge)<br /></div></div></foreignObject><text x="130" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">3: Authenticate (copied signed challenge)&lt;br&gt;</text></switch></g><path d="M 454.48 140.22 C 455.67 140.22 456.51 139.68 456.27 139.27 L 453.9 135.27 C 453.6 134.67 453.17 134.54 452.46 134.54 L 437.04 134.54 C 436.29 134.54 435.9 134.69 435.54 135.3 L 433.33 139.24 C 432.9 139.88 434.19 140.22 435.11 140.22 Z M 490.51 127.24 L 490.51 68.8 L 398.93 68.8 L 398.93 127.24 Z M 388.95 145.5 C 386.51 145.48 384.32 144.55 383.4 143.11 C 382.5 141.7 382.86 140.29 383.64 139.32 L 392.5 129.07 L 392.5 68.49 C 392.5 65.44 394.9 61.5 398.89 61.5 L 490.53 61.5 C 493.63 61.5 496.93 64.32 496.93 68.88 L 496.93 129.07 L 505.89 139.41 C 506.64 140.39 507 141.68 506.1 143.07 C 504.92 144.82 502.69 145.38 500.6 145.5 Z" fill="#ff3333" stroke="#b85450" stroke-width="1.5" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(405.5,157.5)scale(1.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="52" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">Attacker<br /></div></div></foreignObject><text x="26" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">Attacker&lt;br&gt;</text></switch></g><path d="M 27.95 137.56 L 89.18 137.56 L 89.18 101.66 L 27.95 101.66 Z M 26.48 142.86 C 24.61 142.86 22.63 141.3 22.63 138.96 L 22.63 100.17 C 22.63 98.27 24.21 96.36 26.53 96.36 L 90.6 96.36 C 92.94 96.36 94.5 98.33 94.5 100.15 L 94.5 138.79 C 94.5 141.16 92.83 142.86 90.4 142.86 L 67.08 142.86 C 66.62 144.49 66.16 146.23 66.07 147.7 C 65.87 150.69 67.79 151.56 71.2 152.04 C 73.49 152.33 75.51 152.38 77.68 152.43 C 78.99 152.43 80.25 153.41 80.25 154.97 C 80.25 156.47 79.18 157.5 77.69 157.5 L 39.5 157.48 C 38.15 157.48 37 156.4 37 154.97 C 37 153.69 38.01 152.45 39.5 152.45 C 42.02 152.36 44.6 152.34 47.24 151.85 C 49.78 151.35 51.34 150.39 51.06 147.54 C 50.95 146.21 50.51 144.49 50.05 142.86 Z M 9.32 73.77 L 38.6 73.77 L 38.6 69.76 L 9.32 69.76 Z M 0 150.84 L 0 63.01 C 0 60.03 2.72 57.82 5.09 57.82 L 42.75 57.82 C 45.38 57.82 47.92 60.16 47.92 63.03 L 47.92 92.36 L 26.34 92.36 C 22.29 92.36 18.63 96.11 18.63 100.1 L 18.63 124.25 L 9.32 124.25 L 9.32 128.26 L 18.63 128.26 L 18.63 136.22 L 9.32 136.22 L 9.32 140.2 L 18.74 140.2 C 19.5 144.4 23.21 146.87 26.32 146.87 L 46.85 146.87 C 46.85 147.19 46.99 147.52 46.97 147.77 C 45.63 148.23 42.59 148.44 40.02 148.46 C 38.88 148.41 37.91 148.53 36.91 148.94 C 35.94 149.33 35.08 149.97 34.36 150.84 Z" fill="#505050" stroke="none" pointer-events="none"/><path d="M 73.2 71.11 L 73.2 55.3 L 93.17 52.5 L 93.17 71.11 Z M 55.9 71.11 L 55.9 57.82 L 71.87 55.57 L 71.87 71.11 Z M 73.2 88.12 L 73.2 72.44 L 93.17 72.44 L 93.17 88.12 Z M 55.9 85.71 L 55.9 72.44 L 71.87 72.44 L 71.87 88 Z" fill="#27ace2" stroke="none" pointer-events="none"/><path d="M 938.31 72.36 L 919.8 72.36 L 919.8 58.18 L 938.31 55.75 Z M 939.86 72.36 L 939.86 55.47 L 963 52.5 L 963 72.36 Z M 939.86 90.53 L 939.86 73.78 L 963 73.78 L 963 93.1 Z M 919.8 87.95 L 919.8 73.78 L 938.31 73.78 L 938.31 90.38 Z" fill="#27ace2" stroke="none" pointer-events="none"/><path d="M 865.8 75.2 L 899.74 75.2 L 899.74 70.95 L 865.8 70.95 Z M 865.8 133.38 L 899.74 133.38 L 899.74 129.12 L 865.8 129.12 Z M 865.8 146.15 L 899.74 146.15 L 899.74 141.89 L 865.8 141.89 Z M 855 157.5 L 855 63.72 C 855 60.5 858.19 58.18 860.99 58.18 L 904.39 58.18 C 907.89 58.18 910.54 60.84 910.54 63.76 L 910.54 157.5 Z" fill="#505050" stroke="none" pointer-events="none"/><path d="M 120 27 L 359.84 27" fill="none" stroke="#000000" stroke-width="4.5" stroke-miterlimit="10" pointer-events="none"/><path d="M 369.97 27 L 356.47 33.75 L 359.84 27 L 356.47 20.25 Z" fill="#000000" stroke="#000000" stroke-width="4.5" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(112.5,-1.5)scale(1.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="170" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;background-color:#ffffff;">1: Negotiate authentication<br /></div></div></foreignObject><text x="85" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">1: Negotiate authentication&lt;br&gt;</text></switch></g><path d="M 375 102 L 135.16 102" fill="none" stroke="#000000" stroke-width="4.5" stroke-miterlimit="10" pointer-events="none"/><path d="M 125.03 102 L 138.53 95.25 L 135.16 102 L 138.53 108.75 Z" fill="#000000" stroke="#000000" stroke-width="4.5" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(130.5,73.5)scale(1.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="166" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;background-color:#ffffff;">2: Copied server challenge<br /></div></div></foreignObject><text x="83" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">2: Copied server challenge&lt;br&gt;</text></switch></g><path d="M 120 172.5 L 359.84 172.5" fill="none" stroke="#000000" stroke-width="4.5" stroke-miterlimit="10" pointer-events="none"/><path d="M 369.97 172.5 L 356.47 179.25 L 359.84 172.5 L 356.47 165.75 Z" fill="#000000" stroke="#000000" stroke-width="4.5" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(55.5,188.5)scale(1.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="246" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;background-color:#ffffff;">3: Authenticate (with signed challenge)<br /></div></div></foreignObject><text x="123" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">3: Authenticate (with signed challenge)&lt;br&gt;</text></switch></g><path d="M 373.5 262.5 L 133.66 262.5" fill="none" stroke="#ff3333" stroke-width="4.5" stroke-miterlimit="10" pointer-events="none"/><path d="M 123.53 262.5 L 137.03 255.75 L 133.66 262.5 L 137.03 269.25 Z" fill="#ff3333" stroke="#ff3333" stroke-width="4.5" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(155.5,233.5)scale(1.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="130" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;background-color:#ffffff;">Authentication failed<br /></div></div></foreignObject><text x="65" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">Authentication failed&lt;br&gt;</text></switch></g><path d="M 780 261 L 540.16 261" fill="none" stroke="#ff3333" stroke-width="4.5" stroke-miterlimit="10" pointer-events="none"/><path d="M 530.03 261 L 543.53 254.25 L 540.16 261 L 543.53 267.75 Z" fill="#ff3333" stroke="#ff3333" stroke-width="4.5" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(574.5,232.5)scale(1.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="114" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;background-color:#ffffff;">Authentication OK<br /></div></div></foreignObject><text x="57" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">Authentication OK&lt;br&gt;</text></switch></g><path d="M 525 322.5 L 764.84 322.5" fill="none" stroke="#ff3333" stroke-width="4.5" stroke-miterlimit="10" pointer-events="none"/><path d="M 774.97 322.5 L 761.47 329.25 L 764.84 322.5 L 761.47 315.75 Z" fill="#ff3333" stroke="#ff3333" stroke-width="4.5" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(555.5,294.5)scale(1.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="120" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;background-color:#ffffff;">Relayed interaction<br /></div></div></foreignObject><text x="60" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">Relayed interaction&lt;br&gt;</text></switch></g></svg>